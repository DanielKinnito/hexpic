"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e,t,r){return Math.round(.2126*e+.7152*t+.0722*r)}function r(e,t){const r=(e-128)*t+128;return Math.min(255,Math.max(0,r))}function o(e,t){return t>0?e+(255-e)*t:t<0?e+e*t:e}function n(e,t){const r=Math.min(255,Math.max(0,e))/255,o=Math.pow(r,1.5),n=Math.floor(o*(t.length-1));return t[Math.min(Math.max(n,0),t.length-1)]}const a={width:80,height:40,charset:"$@B%8&WM#*oahkbdpqwmZO0QLCJUYXzcvunxrjft/\\|()1{}[]?-_+~<>i!lI;:,\"^`'. ",invert:!1,contrast:1,brightness:0,preserveAspectRatio:!0,backgroundColor:"#000000",fontAspectRatio:.55};class i{constructor(e={}){this.options={...a,...e},this.canvas=document.createElement("canvas");const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw new Error("Could not create canvas context");this.ctx=t}setOptions(e){this.options={...this.options,...e}}async fromImageElement(e,t){return this.convertImage(e,t)}async fromUrl(e){const t=await function(e){return new Promise((t,r)=>{const o=new Image;o.crossOrigin="Anonymous",o.onload=()=>t(o),o.onerror=e=>r(new Error(`Failed to load image: ${e}`)),o.src=e})}(e);return this.convertImage(t)}fromFile(e){return new Promise((t,r)=>{const o=new FileReader;o.onload=async e=>{var o;try{if(!(null===(o=e.target)||void 0===o?void 0:o.result))throw new Error("Failed to read file");const n=new Image;n.onload=async()=>{try{const e=await this.convertImage(n);t(e)}catch(e){r(e)}},n.onerror=()=>r(new Error("Failed to load image from file")),n.src=e.target.result}catch(e){r(e)}},o.onerror=()=>r(new Error("Failed to read file")),o.readAsDataURL(e)})}async convertImage(e,a){const i={...this.options,...a},{width:s,height:c,contrast:l,brightness:u,invert:f,charset:d,backgroundColor:p,preserveAspectRatio:y,fontAspectRatio:m}=i;let h=s,g=c;if(y){const t=e.width/e.height/m;h/g>t?h=Math.floor(g*t):g=Math.floor(h/t)}this.canvas.width=h,this.canvas.height=g,function(e,t){const r=e.getContext("2d");r&&(r.fillStyle=t,r.fillRect(0,0,e.width,e.height))}(this.canvas,p),this.ctx.drawImage(e,0,0,h,g);const v=this.ctx.getImageData(0,0,h,g).data;let b="";for(let e=0;e<g;e++){for(let a=0;a<h;a++){const i=4*(e*h+a);let s=t(v[i],v[i+1],v[i+2]);s=r(s,l),s=o(s,u),s=f?255-s:s,b+=n(s,d)}b+="\n"}return{ascii:b,width:h,height:g,charset:d}}}var s,c={exports:{}},l={};var u,f={};
/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */"production"===process.env.NODE_ENV?c.exports=function(){if(s)return l;s=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(t,r,o){var n=null;if(void 0!==o&&(n=""+o),void 0!==r.key&&(n=""+r.key),"key"in r)for(var a in o={},r)"key"!==a&&(o[a]=r[a]);else o=r;return r=o.ref,{$$typeof:e,type:t,key:n,ref:void 0!==r?r:null,props:o}}return l.Fragment=t,l.jsx=r,l.jsxs=r,l}():c.exports=(u||(u=1,"production"!==process.env.NODE_ENV&&function(){function t(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===O?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case m:return"Fragment";case g:return"Profiler";case h:return"StrictMode";case x:return"Suspense";case _:return"SuspenseList";case j:return"Activity"}if("object"==typeof e)switch("number"==typeof e.tag&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case y:return"Portal";case b:return e.displayName||"Context";case v:return(e._context.displayName||"Context")+".Consumer";case w:var r=e.render;return(e=e.displayName)||(e=""!==(e=r.displayName||r.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case S:return null!==(r=e.displayName||null)?r:t(e.type)||"Memo";case k:r=e._payload,e=e._init;try{return t(e(r))}catch(e){}}return null}function r(e){return""+e}function o(e){try{r(e);var t=!1}catch(e){t=!0}if(t){var o=(t=console).error,n="function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return o.call(t,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",n),r(e)}}function n(e){if(e===m)return"<>";if("object"==typeof e&&null!==e&&e.$$typeof===k)return"<...>";try{var r=t(e);return r?"<"+r+">":"<...>"}catch(e){return"<...>"}}function a(){return Error("react-stack-top-frame")}function i(){var e=t(this.type);return A[e]||(A[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),void 0!==(e=this.props.ref)?e:null}function s(e,r,n,a,s,l){var f,d=r.children;if(void 0!==d)if(a)if(R(d)){for(a=0;a<d.length;a++)c(d[a]);Object.freeze&&Object.freeze(d)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else c(d);if(P.call(r,"key")){d=t(e);var y=Object.keys(r).filter(function(e){return"key"!==e});a=0<y.length?"{key: someKey, "+y.join(": ..., ")+": ...}":"{key: someKey}",F[d+a]||(y=0<y.length?"{"+y.join(": ..., ")+": ...}":"{}",console.error('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',a,d,y,d),F[d+a]=!0)}if(d=null,void 0!==n&&(o(n),d=""+n),function(e){if(P.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(r)&&(o(r.key),d=""+r.key),"key"in r)for(var m in n={},r)"key"!==m&&(n[m]=r[m]);else n=r;return d&&function(e,t){function r(){u||(u=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",t))}r.isReactWarning=!0,Object.defineProperty(e,"key",{get:r,configurable:!0})}(n,"function"==typeof e?e.displayName||e.name||"Unknown":e),function(e,t,r,o,n,a){var s=r.ref;return e={$$typeof:p,type:e,key:t,props:r,_owner:o},null!==(void 0!==s?s:null)?Object.defineProperty(e,"ref",{enumerable:!1,get:i}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:n}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:a}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}(e,d,n,null===(f=E.A)?null:f.getOwner(),s,l)}function c(e){l(e)?e._store&&(e._store.validated=1):"object"==typeof e&&null!==e&&e.$$typeof===k&&("fulfilled"===e._payload.status?l(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function l(e){return"object"==typeof e&&null!==e&&e.$$typeof===p}var u,d=e,p=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),b=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),O=Symbol.for("react.client.reference"),E=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,P=Object.prototype.hasOwnProperty,R=Array.isArray,I=console.createTask?console.createTask:function(){return null},A={},N=(d={react_stack_bottom_frame:function(e){return e()}}).react_stack_bottom_frame.bind(d,a)(),C=I(n(a)),F={};f.Fragment=m,f.jsx=function(e,t,r){var o=1e4>E.recentlyCreatedOwnerStacks++;return s(e,t,r,!1,o?Error("react-stack-top-frame"):N,o?I(n(e)):C)},f.jsxs=function(e,t,r){var o=1e4>E.recentlyCreatedOwnerStacks++;return s(e,t,r,!0,o?Error("react-stack-top-frame"):N,o?I(n(e)):C)}}()),f);var d=c.exports;function p(t={}){var r,o,n;const[a,s]=e.useState(null),[c,l]=e.useState(!1),[u,f]=e.useState(null),d=e.useRef(t);e.useEffect(()=>{d.current=t},[t]);const p=e.useCallback(async(e,t)=>{console.log("useHexPic: convert called",{source:e,options:t}),l(!0),f(null);try{const r={...d.current,...t};console.log("useHexPic: options merged",r);const o=new i(r);let n;"string"==typeof e?(console.log("useHexPic: converting from URL"),n=await o.fromUrl(e)):e instanceof File?(console.log("useHexPic: converting from File"),n=await o.fromFile(e)):(console.log("useHexPic: converting from Image Element"),n=await o.fromImageElement(e)),console.log("useHexPic: conversion successful",{width:n.width,height:n.height,asciiLength:n.ascii.length}),s(n)}catch(e){console.error("useHexPic: conversion failed",e),f(e instanceof Error?e:new Error(String(e))),s(null)}finally{l(!1)}},[]);return{ascii:null!==(r=null==a?void 0:a.ascii)&&void 0!==r?r:"",width:null!==(o=null==a?void 0:a.width)&&void 0!==o?o:0,height:null!==(n=null==a?void 0:a.height)&&void 0!==n?n:0,result:a,isLoading:c,error:u,convert:p}}exports.HexPic=i,exports.HexPicImage=({src:t,alt:r,options:o,style:n,...a})=>{const{ascii:i,isLoading:s,error:c,convert:l}=p(o);return e.useEffect(()=>{t&&l(t)},[t,l,o]),c?(console.error("HexPicImage error:",c),d.jsx("div",{style:{color:"red",...n},...a,children:"Error generating ASCII art"})):d.jsx("div",{style:{fontFamily:"monospace",whiteSpace:"pre",lineHeight:"0.6em",overflow:"hidden",fontSize:"10px",...n},"aria-label":r||"ASCII Art",role:"img",...a,children:s?"Loading...":i})},exports.default=i,exports.useHexPic=p;
//# sourceMappingURL=index.js.map
